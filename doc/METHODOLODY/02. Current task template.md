# Task: [–ù–ê–ó–í–ê–ù–ò–ï –ó–ê–î–ê–ß–ò]

**Started**: YYYY-MM-DD **Status**: üîÑ In Progress **Priority**: High | Medium | Low **Estimated effort**: X hours **Actual effort**: - hours (update as you go)

---

## Task Definition

### Original Request

[–¢–≤–æ—ë –∏—Å—Ö–æ–¥–Ω–æ–µ –Ω–µ—á—ë—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏]

### Clarifying Questions & Answers

**Q1**: [–í–æ–ø—Ä–æ—Å –æ—Ç Claude]  
**A1**: [–¢–≤–æ–π –æ—Ç–≤–µ—Ç]

**Q2**: [–í–æ–ø—Ä–æ—Å –æ—Ç Claude]  
**A2**: [–¢–≤–æ–π –æ—Ç–≤–µ—Ç]

### Similar Implementations (Benchmarks)

- **Implementation 1**: [–≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å]
    - Files: path/to/file.py
    - Pattern: [–∫–∞–∫–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω]
- **Implementation 2**: [–æ–ø–∏—Å–∞–Ω–∏–µ]
    - Files: path/to/file.py
    - Pattern: [–ø–∞—Ç—Ç–µ—Ä–Ω]

### Refined Task Description

**Task Title**: [–ö–æ—Ä–æ—Ç–∫–æ–µ, —á—ë—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ]

**Description**: [–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω–æ –ª—é–±–æ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.]

**Use Cases**:

1. **UC1**: [Actor] needs to [action] in order to [goal]
    - Example: Dispatcher needs to change route status to "In Progress" when driver starts delivery
2. **UC2**: [Actor] needs to [action] in order to [goal]

**Scope**:

- ‚úÖ **In scope**:
    - Feature/component 1
    - Feature/component 2
    - Feature/component 3
- ‚ùå **Out of scope** (not in this task, maybe later):
    - Thing 1 (reason why out of scope)
    - Thing 2 (can be separate task)

**Success Criteria**:

- [ ] Criterion 1: specific, measurable condition
- [ ] Criterion 2: specific, measurable condition
- [ ] Criterion 3: specific, measurable condition

**Technical Considerations**:

- Consideration 1: [technical constraint or requirement]
- Consideration 2: [integration point or dependency]
- Consideration 3: [performance or scalability concern]

### Complexity Assessment

**Complexity**: Low | Medium | High

**Estimated effort**: X-Y hours breakdown:

- Phase 1 Research: ~X hours
- Phase 2 Plan: ~X hours
- Phase 3 Implementation: ~X hours
- Phase 4 Refactoring: ~X hours
- Phase 5 Testing: ~X hours
- Phase 6 Documentation: ~X hours

**Risk factors**:

- üü° Risk 1: [description, mitigation]
- üî¥ Risk 2: [description, mitigation]

### Components to Modify

**Django Backend**:

- Models: [which models will be created/modified]
- Views/ViewSets: [which views]
- Serializers: [which serializers]
- Services: [which services]
- Migrations: [expected migrations]

**Flutter Frontend** (if applicable):

- Screens: [which screens]
- Widgets: [which widgets]
- Providers/State: [which providers]
- Services: [API services]

**Database**:

- New tables: [if any]
- Modified tables: [which tables, what changes]
- New fields: [list]
- Indexes needed: [on which fields]

**API Changes**:

- New endpoints: [list]
- Modified endpoints: [list]
- Breaking changes: [yes/no, details]

### Dependencies

**This task depends on**:

- Component/Task A: [why, what's needed]
- Component/Task B: [why, what's needed]

**Will affect these components**:

- Component C: [how it will be affected]
- Component D: [what changes needed there]

**External dependencies**:

- Library/Service X: [if using new library or service]

### Recommended Approach

[Brief high-level approach suggested by Claude. Will be refined in Planning phase]

Example:

1. Extend existing StatusSchema model from orders app
2. Create Route status transitions similar to Order transitions
3. Add API endpoints for status management
4. Update Flutter UI to show and change route status
5. Add tests for status workflow
6. Document the new status flow

---

## Research

### 1. –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**Django Apps –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω—ã**:

- app_name - –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**–ú–æ–¥–µ–ª–∏**:

- `ModelName` (apps/app_name/models.py)
    - key_field: description
    - another_field: description
    - related_field: ForeignKey to OtherModel

**API Endpoints**:

- POST /api/endpoint/ - description
- GET /api/endpoint/ - description

**Services/Utils**:

- service_name.py - what it does

**Frontend (–µ—Å–ª–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ)**:

- Flutter screens/widgets involved
- State management approach

---

### 2. –°–≤—è–∑–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏—Ç –æ—Ç**:

- Component A - how
- Component B - why

**–û—Ç —ç—Ç–æ–≥–æ –∑–∞–≤–∏—Å–∏—Ç**:

- Component C - impact if changed
- Component D - considerations

**–í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**:

- Google Maps API - for geocoding
- TimescaleDB - for GPS tracking

---

### 3. –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–æ–±–ª–µ–º—ã

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥**:

- Issue 1: description
- Issue 2: description

**Known issues**:

- Bug/limitation 1
- Bug/limitation 2

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:

- Risk 1: what could go wrong
- Risk 2: mitigation strategy

---

### 4. –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏**:

- Service layer pattern (apps/orders/services.py)
- Signals for post-save actions
- DRF ViewSets for API

**Consistency —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**:

- Follow existing naming conventions
- Use similar structure as app_name

---

## Plan

### 1. Backend Changes

#### Models

- [ ] Create/modify ModelName
    
    - Add fields: field1, field2
    - Add indexes: on field1
    - Migration: description
- [ ] Update RelatedModel (if needed)
    

#### Serializers

- [ ] Create NewSerializer
    
    - Fields: field1, field2, field3
    - Validation: what to validate
- [ ] Update ExistingSerializer
    
    - Add fields: new_field
    - Custom validation for: field_name

#### Views/ViewSets

- [ ] Create NewViewSet
    
    - Endpoints: POST, GET, PATCH
    - Permissions: who can access
    - Filters: what filters
- [ ] Update ExistingViewSet
    
    - Add action: action_name
    - Modify queryset: how

#### Services/Utils

- [ ] Create new_service.py
    
    - Function: function_name - what it does
    - Function: another_function - purpose
- [ ] Update existing_service.py
    
    - Modify: function_name - changes needed

#### Signals/Tasks (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

- [ ] Add signal: signal_name
    
    - Trigger: when
    - Action: what to do
- [ ] Create Celery task: task_name
    
    - Purpose: what it does
    - Schedule: when it runs

---

### 2. Frontend Changes (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

#### Flutter Screens/Widgets

- [ ] Create ScreenName
    
    - Purpose: what user sees
    - State: what data it needs
- [ ] Update ExistingScreen
    
    - Add: new functionality

#### State Management (Riverpod)

- [ ] Create provider: provider_name
    - Type: StateProvider/FutureProvider/etc
    - Purpose: what state it manages

#### API Integration

- [ ] Create API service: service_name
    - Endpoints to call: list

---

### 3. –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- [ ] **–ü—É–Ω–∫—Ç 1**: [–ù–∞–∑–≤–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–∞]
    
    - **–§–∞–π–ª—ã**: path/to/file.py
    - **–î–µ–π—Å—Ç–≤–∏—è**:
        1. Create/modify X
        2. Add Y
        3. Update Z
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
        1. Run migration
        2. Test in admin panel
        3. Verify API response
    - **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: None (or depends on –ü—É–Ω–∫—Ç X)
- [ ] **–ü—É–Ω–∫—Ç 2**: [–ù–∞–∑–≤–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–∞]
    
    - **–§–∞–π–ª—ã**: path/to/file.py, path/to/another.py
    - **–î–µ–π—Å—Ç–≤–∏—è**:
        1. Action 1
        2. Action 2
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
        1. Test step 1
        2. Test step 2
    - **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –ü—É–Ω–∫—Ç 1
- [ ] **–ü—É–Ω–∫—Ç 3**: [–ù–∞–∑–≤–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–∞]
    
    - **–§–∞–π–ª—ã**:
    - **–î–µ–π—Å—Ç–≤–∏—è**:
    - **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
    - **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:

[Add more –ø—É–Ω–∫—Ç—ã as needed]

---

### 4. Testing Strategy

**Unit Tests**:

- Models: test_model_creation, test_model_validation, test_model_methods
- Serializers: test_serialization, test_deserialization, test_validation
- Services: test_service_function_1, test_service_function_2

**Integration Tests**:

- API: test_endpoint_post, test_endpoint_get, test_permissions
- Workflows: test_full_workflow_happy_path, test_workflow_error_cases

**Edge Cases** (what could go wrong):

- Empty lists
- Null values
- Boundary conditions (e.g., max weight, date in past)
- Concurrent updates
- Missing related objects

---

### 5. Risks and Considerations

**What could break**:

- Existing functionality X might be affected
- API changes could break mobile apps

**Backward compatibility**:

- Need migration strategy for existing data
- API versioning considerations

**Performance concerns**:

- Large dataset queries - need indexes
- Real-time updates - consider websockets

**Deployment considerations**:

- Run migrations: yes/no
- Feature flags needed: yes/no
- Rollback plan: what to do if fails

---

## Implementation

### Completed Items

- [x] **–ü—É–Ω–∫—Ç 1**: [–Ω–∞–∑–≤–∞–Ω–∏–µ] - completed YYYY-MM-DD
    
    - Files changed: apps/orders/models.py, apps/orders/migrations/0023_add_field.py
    - Changes: Added field_name to Order model
    - Tested: ‚úÖ Manual testing passed
    - Notes: [any issues encountered or decisions made]
- [x] **–ü—É–Ω–∫—Ç 2**: [–Ω–∞–∑–≤–∞–Ω–∏–µ] - completed YYYY-MM-DD
    
    - Files changed:
    - Changes:
    - Tested: ‚úÖ
    - Notes:

### In Progress

- [ ] **–ü—É–Ω–∫—Ç 3**: [–Ω–∞–∑–≤–∞–Ω–∏–µ] - in progress
    - Started: YYYY-MM-DD
    - Current status: [what's done, what remains]
    - Issues: [any blockers or problems]

### Pending

- [ ] **–ü—É–Ω–∫—Ç 4**: [–Ω–∞–∑–≤–∞–Ω–∏–µ]
- [ ] **–ü—É–Ω–∫—Ç 5**: [–Ω–∞–∑–≤–∞–Ω–∏–µ]

---

## Refactoring

### Issues Found

#### üî¥ Critical Issues

1. **[Issue Name]**
    
    - **File**: path/to/file.py:line_numbers
    - **Problem**: Description of the problem
    - **Current code**:
    
    ```python
    # problematic code here
    ```
    
    - **Suggested fix**:
    
    ```python
    # fixed code here
    ```
    
    - **Why**: Explanation of why this is a problem
    - **Status**: ‚ùå Not fixed | üîÑ In progress | ‚úÖ Fixed YYYY-MM-DD

#### üü° Major Issues

1. **[Issue Name]**
    
    - **File**:
    - **Problem**:
    - **Current code**:
    
    - **Suggested fix**:
    
    - **Why**:
    - **Status**:

#### üü¢ Minor Issues

1. **[Issue Name]**
    - **File**:
    - **Problem**:
    - **Status**: ‚è∏Ô∏è Postponed (low priority) | ‚úÖ Fixed

---

### Improvements Applied

- [x] All Critical issues fixed - YYYY-MM-DD
- [x] Most Major issues fixed - YYYY-MM-DD
- [ ] Some Minor issues postponed

### Refactoring Summary

- **Code quality**: [improved/good/needs work]
- **Performance**: [optimized/acceptable/needs optimization]
- **Maintainability**: [high/medium/low]
- **Test coverage**: [will be addressed in Testing phase]

---

## Testing

### Test Coverage

- **Overall**: XX%
- **Models**: XX%
- **Serializers**: XX%
- **Views**: XX%
- **Services**: XX%

### Tests Created

- `tests/test_models.py` (X tests)
    - test_model_creation
    - test_model_validation
    - test_model_methods
- `tests/test_serializers.py` (X tests)
    - test_serialization
    - test_deserialization
    - test_validation
- `tests/test_views.py` (X tests)
    - test_endpoint_post_success
    - test_endpoint_post_validation_error
    - test_endpoint_get_list
    - test_endpoint_permissions
- `tests/test_services.py` (X tests)
    - test_service_function_happy_path
    - test_service_function_error_case

### Scenarios Covered

- ‚úÖ Happy path for all endpoints
- ‚úÖ Permission checks (authenticated, unauthenticated, wrong permissions)
- ‚úÖ Validation errors (missing fields, invalid formats, business logic)
- ‚úÖ Edge cases from Plan section
- ‚úÖ Error handling (404, 400, 500)

### Test Results

```bash
$ pytest apps/app_name/tests/
========================= X passed in Y.YYs =========================

$ pytest --cov=apps/app_name --cov-report=html
Coverage: XX%
```

### Edge Cases Tested

- [x] Empty input data
- [x] Null/None values
- [x] Boundary conditions (max values, dates, etc)
- [x] Concurrent operations
- [x] Missing related objects

---

## Documentation

### Created Files

**Technical Documentation**:

- [x] `docs/architecture/django-backend/workflows/[feature-name].md` - YYYY-MM-DD
    - Architecture diagrams
    - Data model
    - API documentation
    - Implementation details

**Feature Documentation**:

- [x] `docs/features/[feature-name]/overview.md` - YYYY-MM-DD
    - What, why, for whom
    - High-level description
- [x] `docs/features/[feature-name]/user-guide.md` - YYYY-MM-DD
    - Step-by-step instructions
    - Use case examples
    - FAQs and troubleshooting
- [x] `docs/features/[feature-name]/technical.md` - YYYY-MM-DD
    - Quick reference with link to full technical docs

**Screenshots & Diagrams**:

- [x] X screenshots added to `docs/features/[feature-name]/images/`
    - screenshot-1.png: [description]
    - screenshot-2.png: [description]
- [x] Y diagrams created
    - diagram-flow.png: [description]
    - diagram-architecture.png: [description]

**User Guides (Multi-language)** - Optional, to be done later:

- [ ] `docs/user-guides/en/[app]/[feature-name].md` (already in feature docs)
- [ ] `docs/user-guides/fr/[app]/[feature-name].md` - French translation
- [ ] `docs/user-guides/de/[app]/[feature-name].md` - German translation

**Support Documentation** - To be created as needed:

- [ ] `docs/support/troubleshooting/[feature-name].md` - when issues arise
- [ ] `docs/support/faqs/[feature-name].md` - when questions accumulate
- [ ] `docs/support/known-issues/[feature-name].md` - if there are known issues

### Documentation Links

**For Developers**:

- [Technical Documentation](https://claude.ai/docs/architecture/django-backend/workflows/%5Bfeature-name%5D.md)

**For Users**:

- [Feature Overview](https://claude.ai/docs/features/%5Bfeature-name%5D/overview.md)
- [User Guide](https://claude.ai/docs/features/%5Bfeature-name%5D/user-guide.md)

**For Support**:

- [Troubleshooting Guide](https://claude.ai/docs/support/troubleshooting/%5Bfeature-name%5D.md) (when created)

### Documentation Quality Checklist

**Technical Docs**:

- [x] Sufficient details for new developer to understand
- [x] Architecture diagrams included
- [x] Code examples provided
- [x] API documented with request/response examples
- [x] Links to related documentation

**Feature Docs**:

- [x] Clear for non-technical users (managers, dispatchers)
- [x] Step-by-step instructions with expected results
- [x] Real-world examples and use cases
- [x] Screenshots for key steps
- [x] FAQs cover common questions
- [x] Troubleshooting for common issues

**Completeness**:

- [x] All use cases from Task Definition covered
- [x] All success criteria documented
- [x] Known limitations documented
- [x] Related features linked

---

## Notes

### Decisions Made

1. **Decision**: Why chosen
    
    - **Alternative considered**: Why not chosen
    - **Trade-offs**: What we sacrificed/gained
2. **Decision**:
    
    - **Alternative considered**:
    - **Trade-offs**:

### Issues Encountered

1. **Issue**: Description
    
    - **Resolution**: How it was solved
    - **Time impact**: +X hours
2. **Issue**:
    
    - **Resolution**:
    - **Time impact**:

### Future Improvements

- Improvement 1: What could be better (but not critical now)
- Improvement 2: Technical debt introduced (intentionally or not)
- Improvement 3: Features to consider in future

### Lessons Learned

**What went well** ‚úÖ:

- Point 1
- Point 2

**What could be improved** üîÑ:

- Point 1 ‚Üí how to improve next time
- Point 2 ‚Üí what to do differently

### Related Tasks

- Links to related tasks/tickets
- Dependencies for other teams

---

## Metrics

### Time Tracking

- **Research**: X hours (estimated: Y hours)
- **Planning**: X hours (estimated: Y hours)
- **Implementation**: X hours (estimated: Y hours)
- **Refactoring**: X hours (estimated: Y hours)
- **Testing**: X hours (estimated: Y hours)
- **Documentation**: X hours (estimated: Y hours)
- **Total**: X hours (estimated: Y hours)

### Code Changes

- Files modified: X
- Lines added: X
- Lines removed: X
- Net change: +/- X lines

### Quality Metrics

- Test coverage: XX%
- Code quality score: [tool score if available]
- Performance impact: [improvement/degradation percentage]

---

**Status**: üîÑ In Progress | ‚úÖ Completed | ‚è∏Ô∏è Paused | ‚ùå Cancelled **Completed**: YYYY-MM-DD (when done)

---

## Quick Checklist (–¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ Cleanup)

- [ ] All Implementation –ø—É–Ω–∫—Ç—ã marked as completed
- [ ] All üî¥ Critical refactoring issues fixed
- [ ] Most üü° Major refactoring issues fixed
- [ ] Test coverage ‚â• 85%
- [ ] All tests passing
- [ ] Technical documentation created
- [ ] User documentation created
- [ ] Screenshots added (if applicable)
- [ ] Code reviewed (self-review using REFACTORING_CHECKLIST.md)
- [ ] Migration tested (if applicable)
- [ ] API documentation updated (if endpoints changed)
- [ ] ARCHITECTURE.md updated (if architecture changed)
- [ ] Lessons learned documented
- [ ] Ready to archive to COMPLETED_TASKS/